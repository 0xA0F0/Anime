!function(){"use strict";let e=0;function t(t,n=!1){let a=document.querySelector(".new_block .results"),i=document.querySelector(".popular-img");n||(a.innerHTML="",e=0);let r=`https://api.tenor.com/v1/search?key=LIVDSRZULELA&q=${t}&limit=28&pos=${e}`;fetch(r).then(e=>e.json()).then(t=>{let n=t.results;n.forEach(e=>{let t=document.createElement("img");t.src=e.media[0].gif.url,t.alt=e.title,t.addEventListener("click",()=>{let e=document.querySelectorAll(".this-place");e.forEach(e=>{let l=e.selectionStart,n=e.value.substring(0,l),a=e.value.substring(l),i=t.src,r=`[img=${i} w=40 h=40]`;e.value=n+r+a,e.setSelectionRange(l+r.length,l+r.length)});let n=document.querySelectorAll(".popular-img img"),a=!1;if(n.forEach(e=>{e.src===t.src&&(a=!0)}),!a){let r=t.cloneNode(!0);r.addEventListener("click",()=>{let e=document.querySelectorAll(".this-place");e.forEach(e=>{let t=e.selectionStart,l=e.value.substring(0,t),n=e.value.substring(t),a=r.src,i=`[img=${a} w=40 h=40]`;e.value=l+i+n,e.setSelectionRange(t+i.length,t+i.length)})}),n.length>=49&&n[0].remove(),i.appendChild(r),l()}}),a.appendChild(t)}),e+=28;let r=document.querySelector(".load_more");r&&(r.style.display=n.length>0?"inline-block":"none"),a.querySelectorAll("img").length>0?i.style.display="none":i.style.display="grid"}).catch(e=>console.error("Ошибка:",e))}function l(){let e=Array.from(document.querySelectorAll(".popular-img img")).map(e=>e.src);localStorage.setItem("popularImages",JSON.stringify(e))}document.addEventListener("DOMContentLoaded",function(){!function e(){let n=document.createElement("style");n.textContent="",document.head.appendChild(n);let a=document.createElement("div");a.className="new_block",a.style.display="none";let i=document.createElement("input");i.type="text",i.className="srch",i.placeholder="Что ищешь?";let r=document.createElement("button");r.textContent="Найти",r.className="search-it",r.setAttribute("type","button"),r.addEventListener("click",function(){let e=i.value;t(e)}),a.appendChild(i),a.appendChild(r);let c=document.createElement("button");c.className="pushme mdi mdi-emoticon titled",c.setAttribute("type","button"),c.setAttribute("title","Гиф");let s=document.createElement("div");s.className="popular-img",a.appendChild(s);let o=document.createElement("div");o.className="results",a.appendChild(o);let u=document.createElement("div");u.className="all",u.appendChild(c),u.appendChild(a);let d=document.querySelector(".bt-bb");d.insertAdjacentElement("afterend",u),c.addEventListener("click",function(){let e=window.getComputedStyle(a).getPropertyValue("display");a.style.display="none"===e?"block":"none",c.classList.toggle("clickme")});let p=document.createElement("button");p.textContent="Загрузить ещё",p.className="load_more",p.setAttribute("type","button"),p.addEventListener("click",function(){let e=document.querySelector(".new_block input").value;t(e,!0)}),a.appendChild(p),s.addEventListener("click",function(e){let t=e.target;if("IMG"===t.tagName){let n=document.querySelectorAll(".this-place");n.forEach(e=>{let l=e.selectionStart,n=e.value.substring(0,l),a=e.value.substring(l),i=t.src,r=`[img=${i} w=40 h=40]`;e.value=n+r+a,e.setSelectionRange(l+r.length,l+r.length)});let a=parseInt(t.dataset.clickCount)||0;a<2?t.dataset.clickCount=a+1:(t.parentNode.removeChild(t),l())}})}(),function e(){let t=document.querySelector(".popular-img");t.innerHTML="";let l=JSON.parse(localStorage.getItem("popularImages"));l&&l.length>0&&l.forEach(e=>{let l=document.createElement("img");l.src=e,t.appendChild(l)})}()})}();